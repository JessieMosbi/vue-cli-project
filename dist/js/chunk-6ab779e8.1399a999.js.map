{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.array.join.js","webpack:///./src/views/admin/Coupons.vue","webpack:///./src/components/CouponModal.vue","webpack:///./src/components/CouponModal.vue?80f5","webpack:///./src/components/DeleteCouponModal.vue","webpack:///./src/components/DeleteCouponModal.vue?582f","webpack:///./src/views/admin/Coupons.vue?5fdd"],"names":["$","IndexedObject","toIndexedObject","arrayMethodIsStrict","nativeJoin","join","ES3_STRINGS","Object","STRICT_METHOD","target","proto","forced","separator","call","this","undefined","class","type","openModal","coupons","coupon","key","id","title","percent","date","due_date","is_enabled","total-pages","page","total","current-page","current","has-pre-page","hasPre","has-next-page","hasNext","getData","temp-coupon","tempCoupon","action","nowAction","list-page","ref","tabindex","role","aria-labelledby","aria-hidden","data-bs-dismiss","aria-label","for","placeholder","code","min","true-value","false-value","editCoupon","props","data","modal","isLoading","loader","watch","status","$loading","show","container","hide","tempTime","Date","mm","getMonth","dd","getDate","getFullYear","console","log","mounted","$refs","methods","alert","temp","getTime","actionName","path","method","$http","then","res","success","$emit","listPage","catch","err","dir","render","deleteCoupon","delete","components","pagination","couponModal","delCouponModal","get","total_pages","current_page","has_pre","has_next","find"],"mappings":"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","file":"js/chunk-6ab779e8.1399a999.js","sourcesContent":["'use strict';\nvar $ = require('../internals/export');\nvar IndexedObject = require('../internals/indexed-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar nativeJoin = [].join;\n\nvar ES3_STRINGS = IndexedObject != Object;\nvar STRICT_METHOD = arrayMethodIsStrict('join', ',');\n\n// `Array.prototype.join` method\n// https://tc39.es/ecma262/#sec-array.prototype.join\n$({ target: 'Array', proto: true, forced: ES3_STRINGS || !STRICT_METHOD }, {\n  join: function join(separator) {\n    return nativeJoin.call(toIndexedObject(this), separator === undefined ? ',' : separator);\n  }\n});\n","<template>\n  <div class=\"text-end mt-4\">\n    <button type=\"button\" class=\"btn btn-primary\" @click=\"openModal('add')\">\n      建立新的優惠券\n    </button>\n  </div>\n  <table class=\"table mt-4\">\n    <thead>\n      <tr>\n        <th>名稱</th>\n        <th>折扣百分比</th>\n        <th>到期日</th>\n        <th>是否啟用</th>\n        <th>編輯</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr v-for=\"coupon in coupons\" :key=\"coupon.id\">\n        <td>{{ coupon.title }}</td>\n        <td>{{ coupon.percent }}</td>\n        <td>{{ this.date(coupon.due_date) }}</td>\n        <td>\n          <span class=\"text-success\" v-if=\"coupon.is_enabled\">啟用</span>\n          <span class=\"text-muted\" v-else>未啟用</span>\n        </td>\n        <td>\n          <div class=\"btn-group\">\n            <button\n              type=\"button\"\n              class=\"btn btn-outline-primary btn-sm\"\n              @click=\"openModal('edit', coupon.id)\"\n            >\n              編輯\n            </button>\n            <button\n              type=\"button\"\n              class=\"btn btn-outline-danger btn-sm\"\n              @click=\"openModal('delete', coupon.id)\"\n            >\n              刪除\n            </button>\n          </div>\n        </td>\n      </tr>\n    </tbody>\n  </table>\n\n  <pagination\n    :total-pages=\"page.total\"\n    :current-page=\"page.current\"\n    :has-pre-page=\"page.hasPre\"\n    :has-next-page=\"page.hasNext\"\n    @change-page=\"getData\"\n  ></pagination>\n\n  <coupon-modal\n    :temp-coupon=\"tempCoupon\"\n    :action=\"nowAction\"\n    :list-page=\"page.current\"\n    @update-data=\"getData\"\n    ref=\"couponModal\"\n  ></coupon-modal>\n  <del-coupon-modal\n    :temp-coupon=\"tempCoupon\"\n    :action=\"nowAction\"\n    @update-data=\"getData\"\n    ref=\"delCouponModal\"\n  ></del-coupon-modal>\n</template>\n\n<script>\n\nimport pagination from '@/components/Pagination.vue'\nimport couponModal from '@/components/CouponModal.vue'\nimport delCouponModal from '@/components/DeleteCouponModal.vue'\n\nexport default {\n  data () {\n    return {\n      coupons: [],\n      page: {\n        total: 0,\n        current: 0,\n        hasPre: false,\n        hasNext: false\n      },\n      tempCoupon: {},\n      nowAction: '',\n      // loading\n      isLoading: false,\n      loader: null\n    }\n  },\n  components: {\n    pagination,\n    couponModal,\n    delCouponModal\n  },\n  mounted () {\n    this.getData()\n  },\n  watch: {\n    isLoading (status) {\n      if (status) {\n        this.loader = this.$loading.show({\n          container: null\n        })\n        return\n      }\n      if (this.loader) this.loader.hide()\n    }\n  },\n  methods: {\n    getData (page = 1) {\n      this.isLoading = true\n\n      this.$http.get(`${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupons?page=${page}`)\n        .then(res => {\n          console.log(res.data)\n\n          if (!res.data.success) {\n            alert('獲取優惠券列表資料失敗！')\n            this.isLoading = false\n            return\n          }\n\n          this.coupons = res.data.coupons\n          this.page.total = res.data.pagination.total_pages\n          this.page.current = res.data.pagination.current_page\n          this.page.hasPre = res.data.pagination.has_pre\n          this.page.hasNext = res.data.pagination.has_next\n          this.isLoading = false\n        })\n        .catch(err => console.dir(err))\n    },\n    openModal (action, id = null) {\n      this.nowAction = action\n\n      if (action === 'add') {\n        this.tempCoupon = { is_enabled: 0 }\n      } else if ((action === 'edit' || action === 'delete') && id) {\n        this.tempCoupon = { ...this.coupons.find(coupon => coupon.id === id) }\n        console.log('Coupons.vue')\n        console.log(this.tempCoupon)\n      }\n\n      if (action === 'add' || action === 'edit') this.$refs.couponModal.openModal()\n      else if (action === 'delete') this.$refs.delCouponModal.openModal()\n    }\n  }\n}\n</script>\n","<template>\n  <div\n    class=\"modal fade\"\n    id=\"couponModal\"\n    tabindex=\"-1\"\n    role=\"dialog\"\n    aria-labelledby=\"exampleModalLabel\"\n    aria-hidden=\"true\"\n    ref=\"modal\"\n  >\n    <div class=\"modal-dialog\" role=\"document\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <h5 class=\"modal-title\" id=\"exampleModalLabel\">\n            <span v-if=\"!coupon.id\">新增優惠卷</span>\n            <span v-else>編輯優惠卷</span>\n          </h5>\n          <button\n            type=\"button\"\n            class=\"btn-close\"\n            data-bs-dismiss=\"modal\"\n            aria-label=\"Close\"\n          ></button>\n        </div>\n        <div class=\"modal-body\">\n          {{ coupon }}\n          <div class=\"mb-3\">\n            <label for=\"title\">標題</label>\n            <input\n              type=\"text\"\n              class=\"form-control\"\n              id=\"title\"\n              v-model=\"coupon.title\"\n              placeholder=\"請輸入標題\"\n            />\n          </div>\n          <div class=\"mb-3\">\n            <label for=\"coupon_code\">優惠碼</label>\n            <input\n              type=\"text\"\n              class=\"form-control\"\n              id=\"coupon_code\"\n              v-model=\"coupon.code\"\n              placeholder=\"請輸入優惠碼\"\n            />\n          </div>\n          <div class=\"mb-3\">\n            <label for=\"due_date\">到期日</label>\n            <input\n              type=\"date\"\n              class=\"form-control\"\n              id=\"due_date\"\n              v-model=\"coupon.due_date\"\n            />\n          </div>\n          <div class=\"mb-3\">\n            <label for=\"price\">折扣百分比</label>\n            <input\n              type=\"number\"\n              class=\"form-control\"\n              id=\"price\"\n              min=\"0\"\n              v-model=\"coupon.percent\"\n              placeholder=\"請輸入折扣百分比\"\n            />\n          </div>\n          <div class=\"mb-3\">\n            <div class=\"form-check\">\n              <input\n                class=\"form-check-input\"\n                type=\"checkbox\"\n                id=\"is_enabled\"\n                v-model=\"coupon.is_enabled\"\n                true-value=\"1\"\n                false-value=\"0\"\n              />\n              <label class=\"form-check-label\" for=\"is_enabled\">\n                是否啟用\n              </label>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button\n            type=\"button\"\n            class=\"btn btn-secondary\"\n            data-bs-dismiss=\"modal\"\n          >\n            Close\n          </button>\n          <button type=\"button\" class=\"btn btn-primary\" @click=\"editCoupon\">\n            <span v-if=\"!coupon.id\">新增</span>\n            <span v-else>更新</span>\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n\nimport Modal from 'bootstrap/js/dist/modal.js'\n\nexport default {\n  props: ['tempCoupon', 'action', 'listPage'],\n  data () {\n    return {\n      modal: null,\n      coupon: { is_enabled: 0 },\n      // loading\n      isLoading: false,\n      loader: null\n    }\n  },\n  watch: {\n    isLoading (status) {\n      if (status) {\n        this.loader = this.$loading.show({\n          container: null\n        })\n        return\n      }\n      if (this.loader) this.loader.hide()\n    },\n    tempCoupon () {\n      // input type date format: yyyy-mm-dd\n      this.coupon = { ...this.tempCoupon }\n\n      if (this.action === 'edit') {\n        const tempTime = new Date(this.tempCoupon.due_date * 1000)\n        const mm = tempTime.getMonth() + 1\n        const dd = tempTime.getDate()\n        this.coupon.due_date = [tempTime.getFullYear(), (mm < 10 ? '0' + mm : mm), (dd < 10 ? '0' + dd : dd)].join('-')\n      }\n      console.log('CouponsOmdal.vue watch')\n      console.log(this.coupon)\n    }\n  },\n  mounted () {\n    this.modal = new Modal(this.$refs.modal, null)\n  },\n  methods: {\n    openModal () {\n      console.log('CouponsOmdal.vue openModal')\n      console.log(this.tempCoupon)\n      this.modal.show()\n    },\n\n    editCoupon () {\n      this.isLoading = true\n\n      if (!this.coupon.title || !this.coupon.percent || !this.coupon.due_date || !this.coupon.code) {\n        alert('請檢查必填欄位！')\n        this.isLoading = false\n        return\n      }\n\n      const temp = { ...this.coupon }\n      temp.due_date = (new Date(temp.due_date).getTime()) / 1000\n      temp.percent = +(temp.percent)\n      temp.is_enabled = +(temp.is_enabled)\n\n      console.log(temp)\n\n      // const tempUnix = (new Date(this.coupon.due_date).getTime()) / 1000\n      // console.log(this.date(tempUnix))\n\n      let actionName = ''\n      let path = ''\n      let method = ''\n      const data = { data: temp }\n      if (this.action === 'add') {\n        actionName = '新增'\n        path = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon`\n        method = 'post'\n      } else if (this.action === 'edit') {\n        actionName = '編輯'\n        path = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon/${temp.id}`\n        method = 'put'\n      }\n\n      this.$http[method](path, data)\n        .then(res => {\n          console.log(res.data)\n          if (!res.data.success) {\n            alert(`${actionName}失敗！`)\n            this.isLoading = false\n            return\n          }\n          alert(`${actionName}成功！`)\n          this.isLoading = false\n\n          this.modal.hide()\n          this.$emit('updateData', this.listPage)\n        })\n        .catch(err => console.dir(err))\n    }\n  }\n}\n</script>\n","import { render } from \"./CouponModal.vue?vue&type=template&id=db3d67e2\"\nimport script from \"./CouponModal.vue?vue&type=script&lang=js\"\nexport * from \"./CouponModal.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <div\n    id=\"delOrderModal\"\n    ref=\"modal\"\n    class=\"modal fade\"\n    tabindex=\"-1\"\n    aria-labelledby=\"delProductModalLabel\"\n    aria-hidden=\"true\"\n  >\n    <div class=\"modal-dialog\">\n      <div class=\"modal-content border-0\">\n        <div class=\"modal-header bg-danger text-white\">\n          <h5 id=\"delProductModalLabel\" class=\"modal-title\">\n            <span>刪除優惠券</span>\n          </h5>\n          <button\n            type=\"button\"\n            class=\"btn-close\"\n            data-bs-dismiss=\"modal\"\n            aria-label=\"Close\"\n          ></button>\n        </div>\n        <div class=\"modal-body\">\n          是否刪除\n          <strong class=\"text-danger\">{{ coupon.title }}</strong>\n          的優惠券(刪除後將無法恢復)。\n        </div>\n        <div class=\"modal-footer\">\n          <button\n            type=\"button\"\n            class=\"btn btn-outline-secondary\"\n            data-bs-dismiss=\"modal\"\n          >\n            取消\n          </button>\n          <button type=\"button\" class=\"btn btn-danger\" @click=\"deleteCoupon\">\n            確認刪除\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n\nimport Modal from 'bootstrap/js/dist/modal.js'\n\nexport default {\n  props: ['tempCoupon'],\n  data () {\n    return {\n      modal: null,\n      coupon: {},\n      // loading\n      isLoading: false,\n      loader: null\n    }\n  },\n  mounted () {\n    this.modal = new Modal(this.$refs.modal, null)\n  },\n  watch: {\n    isLoading (status) {\n      if (status) {\n        this.loader = this.$loading.show({\n          container: null\n        })\n        return\n      }\n      if (this.loader) this.loader.hide()\n    },\n    tempCoupon () {\n      this.coupon = { ...this.tempCoupon }\n      console.log(this.coupon)\n    }\n  },\n  methods: {\n    openModal () {\n      this.modal.show()\n    },\n\n    deleteCoupon () {\n      this.isLoading = true\n\n      this.$http.delete(`${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon/${this.tempCoupon.id}`)\n        .then(res => {\n          console.log(res.data)\n          if (!res.data.success) {\n            alert('刪除優惠券失敗！')\n            this.isLoading = false\n            return\n          }\n          alert('成功刪除優惠券！')\n          this.isLoading = false\n\n          this.modal.hide()\n          this.$emit('updateData')\n        })\n        .catch(err => console.dir(err))\n    }\n  }\n}\n</script>\n","import { render } from \"./DeleteCouponModal.vue?vue&type=template&id=59f70ef2\"\nimport script from \"./DeleteCouponModal.vue?vue&type=script&lang=js\"\nexport * from \"./DeleteCouponModal.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { render } from \"./Coupons.vue?vue&type=template&id=b782d5cc\"\nimport script from \"./Coupons.vue?vue&type=script&lang=js\"\nexport * from \"./Coupons.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}