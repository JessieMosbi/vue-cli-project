{"version":3,"sources":["webpack:///./src/views/admin/Coupons.vue","webpack:///./src/components/CouponModal.vue","webpack:///./src/components/CouponModal.vue?80f5","webpack:///./src/components/DeleteCouponModal.vue","webpack:///./src/components/DeleteCouponModal.vue?582f","webpack:///./src/views/admin/Coupons.vue?5fdd"],"names":["class","type","openModal","coupons","coupon","key","id","title","percent","$formatDate","due_date","is_enabled","pagination","page","getData","temp-coupon","tempCoupon","action","nowAction","list-page","current","ref","tabindex","role","aria-labelledby","aria-hidden","data-bs-dismiss","aria-label","for","isClickSendBtn","placeholder","code","min","true-value","false-value","editCoupon","props","data","modal","watch","this","console","log","mounted","$refs","methods","show","$emitter","emit","temp","Date","getTime","actionName","path","method","$http","then","res","success","$toastMsg","hide","$emit","listPage","catch","err","dir","render","deleteCoupon","delete","total","hasPre","hasNext","components","couponModal","delCouponModal","get","total_pages","current_page","has_pre","has_next","find"],"mappings":"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","file":"js/chunk-2d21d634.81623ba5.js","sourcesContent":["<template>\n  <div class=\"text-end mt-4\">\n    <button type=\"button\" class=\"btn btn-primary\" @click=\"openModal('add')\">\n      建立新的優惠券\n    </button>\n  </div>\n  <table class=\"table mt-4\">\n    <thead>\n      <tr>\n        <th>名稱</th>\n        <th>折扣百分比</th>\n        <th>到期日</th>\n        <th>是否啟用</th>\n        <th>編輯</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr v-for=\"coupon in coupons\" :key=\"coupon.id\">\n        <td>{{ coupon.title }}</td>\n        <td>{{ coupon.percent }}</td>\n        <td>{{ this.$formatDate(coupon.due_date, \"YYYY/MM/DD\") }}</td>\n        <td>\n          <span class=\"text-success\" v-if=\"coupon.is_enabled\">啟用</span>\n          <span class=\"text-muted\" v-else>未啟用</span>\n        </td>\n        <td>\n          <div class=\"btn-group\">\n            <button\n              type=\"button\"\n              class=\"btn btn-outline-primary btn-sm\"\n              @click=\"openModal('edit', coupon.id)\"\n            >\n              編輯\n            </button>\n            <button\n              type=\"button\"\n              class=\"btn btn-outline-danger btn-sm\"\n              @click=\"openModal('delete', coupon.id)\"\n            >\n              刪除\n            </button>\n          </div>\n        </td>\n      </tr>\n    </tbody>\n  </table>\n\n  <pagination :pagination=\"page\" @change-page=\"getData\"></pagination>\n\n  <coupon-modal\n    :temp-coupon=\"tempCoupon\"\n    :action=\"nowAction\"\n    :list-page=\"page.current\"\n    @update-data=\"getData\"\n    ref=\"couponModal\"\n  ></coupon-modal>\n  <del-coupon-modal\n    :temp-coupon=\"tempCoupon\"\n    :action=\"nowAction\"\n    @update-data=\"getData\"\n    ref=\"delCouponModal\"\n  ></del-coupon-modal>\n</template>\n\n<script>\n\nimport pagination from '@/components/Pagination.vue'\nimport couponModal from '@/components/CouponModal.vue'\nimport delCouponModal from '@/components/DeleteCouponModal.vue'\n\nexport default {\n  data () {\n    return {\n      coupons: [],\n      page: {\n        total: 0,\n        current: 0,\n        hasPre: false,\n        hasNext: false\n      },\n      tempCoupon: {},\n      nowAction: ''\n      // loading\n      // isLoading: false,\n      // loader: null\n    }\n  },\n  components: {\n    pagination,\n    couponModal,\n    delCouponModal\n  },\n  mounted () {\n    this.getData()\n  },\n  // watch: {\n  //   isLoading (status) {\n  //     if (status) {\n  //       this.loader = this.$loading.show({\n  //         container: null\n  //       })\n  //       return\n  //     }\n  //     if (this.loader) this.loader.hide()\n  //   }\n  // },\n  methods: {\n    getData (page = 1) {\n      this.$emitter.emit('loading', true)\n\n      this.$http.get(`${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupons?page=${page}`)\n        .then(res => {\n          console.log(res.data)\n\n          if (!res.data.success) {\n            this.$toastMsg('獲取優惠券列表資料失敗！')\n            this.$emitter.emit('loading', false)\n            return\n          }\n\n          this.coupons = res.data.coupons\n          this.page.total = res.data.pagination.total_pages\n          this.page.current = res.data.pagination.current_page\n          this.page.hasPre = res.data.pagination.has_pre\n          this.page.hasNext = res.data.pagination.has_next\n          this.$emitter.emit('loading', false)\n        })\n        .catch(err => console.dir(err))\n    },\n    openModal (action, id = null) {\n      this.nowAction = action\n\n      if (action === 'add') {\n        this.tempCoupon = { is_enabled: 0 }\n      } else if ((action === 'edit' || action === 'delete') && id) {\n        this.tempCoupon = { ...this.coupons.find(coupon => coupon.id === id) }\n        console.log('Coupons.vue')\n        console.log(this.tempCoupon)\n      }\n\n      if (action === 'add' || action === 'edit') this.$refs.couponModal.openModal()\n      else if (action === 'delete') this.$refs.delCouponModal.openModal()\n    }\n  }\n}\n</script>\n","<template>\n  <div\n    class=\"modal fade\"\n    id=\"couponModal\"\n    tabindex=\"-1\"\n    role=\"dialog\"\n    aria-labelledby=\"exampleModalLabel\"\n    aria-hidden=\"true\"\n    ref=\"modal\"\n  >\n    <div class=\"modal-dialog\" role=\"document\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <h5 class=\"modal-title\" id=\"exampleModalLabel\">\n            <span v-if=\"!coupon.id\">新增優惠卷</span>\n            <span v-else>編輯優惠卷</span> {{ isClickSendBtn }}\n          </h5>\n          <button\n            type=\"button\"\n            class=\"btn-close\"\n            data-bs-dismiss=\"modal\"\n            aria-label=\"Close\"\n          ></button>\n        </div>\n        <div class=\"modal-body\">\n          {{ coupon }}\n          <div class=\"mb-3\">\n            <label for=\"title\"><span class=\"text-danger\">*</span> 標題</label>\n            <input\n              type=\"text\"\n              class=\"form-control\"\n              id=\"title\"\n              v-model=\"coupon.title\"\n              placeholder=\"請輸入標題\"\n            />\n            <div\n              class=\"invalid-feedback\"\n              :class=\"{ 'd-block': !coupon.title }\"\n              v-if=\"isClickSendBtn\"\n            >\n              標題為必填\n            </div>\n          </div>\n          <div class=\"mb-3\">\n            <label for=\"coupon_code\"\n              ><span class=\"text-danger\">*</span> 優惠碼</label\n            >\n            <input\n              type=\"text\"\n              class=\"form-control\"\n              id=\"coupon_code\"\n              v-model=\"coupon.code\"\n              placeholder=\"請輸入優惠碼\"\n            />\n            <div\n              class=\"invalid-feedback\"\n              :class=\"{ 'd-block': !coupon.code }\"\n              v-if=\"isClickSendBtn\"\n            >\n              優惠碼為必填\n            </div>\n          </div>\n          <div class=\"mb-3\">\n            <label for=\"due_date\"\n              ><span class=\"text-danger\">*</span> 到期日</label\n            >\n            <input\n              type=\"date\"\n              class=\"form-control\"\n              id=\"due_date\"\n              v-model=\"coupon.due_date\"\n            />\n            <div\n              class=\"invalid-feedback\"\n              :class=\"{ 'd-block': !coupon.due_date }\"\n              v-if=\"isClickSendBtn\"\n            >\n              到期日為必填\n            </div>\n          </div>\n          <div class=\"mb-3\">\n            <label for=\"price\"\n              ><span class=\"text-danger\">*</span> 折扣百分比</label\n            >\n            <input\n              type=\"number\"\n              class=\"form-control\"\n              id=\"price\"\n              min=\"0\"\n              v-model=\"coupon.percent\"\n              placeholder=\"請輸入折扣百分比\"\n            />\n            <div\n              class=\"invalid-feedback\"\n              :class=\"{ 'd-block': !coupon.percent }\"\n              v-if=\"isClickSendBtn\"\n            >\n              折扣百分比為必填\n            </div>\n          </div>\n          <div class=\"mb-3\">\n            <div class=\"form-check\">\n              <input\n                class=\"form-check-input\"\n                type=\"checkbox\"\n                id=\"is_enabled\"\n                v-model=\"coupon.is_enabled\"\n                true-value=\"1\"\n                false-value=\"0\"\n              />\n              <label class=\"form-check-label\" for=\"is_enabled\">\n                是否啟用\n              </label>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button\n            type=\"button\"\n            class=\"btn btn-secondary\"\n            data-bs-dismiss=\"modal\"\n          >\n            Close\n          </button>\n          <button type=\"button\" class=\"btn btn-primary\" @click=\"editCoupon\">\n            <span v-if=\"!coupon.id\">新增</span>\n            <span v-else>更新</span>\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n\nimport Modal from 'bootstrap/js/dist/modal.js'\n\nexport default {\n  props: ['tempCoupon', 'action', 'listPage'],\n  data () {\n    return {\n      isClickSendBtn: 0,\n      modal: null,\n      coupon: { is_enabled: 0 }\n      // loading\n      // isLoading: false,\n      // loader: null\n    }\n  },\n  watch: {\n    // isLoading (status) {\n    //   if (status) {\n    //     this.loader = this.$loading.show({\n    //       container: null\n    //     })\n    //     return\n    //   }\n    //   if (this.loader) this.loader.hide()\n    // },\n    tempCoupon () {\n      // input type date format: yyyy-mm-dd\n      this.coupon = { ...this.tempCoupon }\n\n      if (this.action === 'edit') {\n        this.coupon.due_date = this.$formatDate(this.tempCoupon.due_date, 'YYYY-MM-DD')\n      }\n      console.log('CouponsOmdal.vue watch')\n      console.log(this.coupon)\n    }\n  },\n  mounted () {\n    this.modal = new Modal(this.$refs.modal, null)\n  },\n  methods: {\n    openModal () {\n      console.log('CouponsOmdal.vue openModal')\n      console.log(this.tempCoupon)\n      this.modal.show()\n    },\n\n    editCoupon () {\n      this.isClickSendBtn = 1\n\n      if (!this.coupon.title || !this.coupon.percent || !this.coupon.due_date || !this.coupon.code) {\n        this.$toastMsg('請檢查必填欄位！', 'warning')\n        return\n      }\n\n      this.$emitter.emit('loading', true)\n\n      const temp = { ...this.coupon }\n      temp.due_date = (new Date(temp.due_date).getTime()) / 1000\n      temp.percent = +(temp.percent)\n      temp.is_enabled = +(temp.is_enabled)\n\n      console.log(temp)\n\n      // const tempUnix = (new Date(this.coupon.due_date).getTime()) / 1000\n      // console.log(this.date(tempUnix))\n\n      let actionName = ''\n      let path = ''\n      let method = ''\n      const data = { data: temp }\n      if (this.action === 'add') {\n        actionName = '新增'\n        path = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon`\n        method = 'post'\n      } else if (this.action === 'edit') {\n        actionName = '編輯'\n        path = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon/${temp.id}`\n        method = 'put'\n      }\n\n      this.$http[method](path, data)\n        .then(res => {\n          console.log(res.data)\n          if (!res.data.success) {\n            this.$toastMsg(`${actionName}失敗！`)\n            this.$emitter.emit('loading', false)\n            return\n          }\n          this.$toastMsg(`${actionName}成功！`, 'success')\n          this.$emitter.emit('loading', false)\n\n          this.modal.hide()\n          this.$emit('updateData', this.listPage)\n          this.isClickSendBtn = 0\n        })\n        .catch(err => console.dir(err))\n    }\n  }\n}\n</script>\n","import { render } from \"./CouponModal.vue?vue&type=template&id=1a201102\"\nimport script from \"./CouponModal.vue?vue&type=script&lang=js\"\nexport * from \"./CouponModal.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <div\n    id=\"delOrderModal\"\n    ref=\"modal\"\n    class=\"modal fade\"\n    tabindex=\"-1\"\n    aria-labelledby=\"delProductModalLabel\"\n    aria-hidden=\"true\"\n  >\n    <div class=\"modal-dialog\">\n      <div class=\"modal-content border-0\">\n        <div class=\"modal-header bg-danger text-white\">\n          <h5 id=\"delProductModalLabel\" class=\"modal-title\">\n            <span>刪除優惠券</span>\n          </h5>\n          <button\n            type=\"button\"\n            class=\"btn-close\"\n            data-bs-dismiss=\"modal\"\n            aria-label=\"Close\"\n          ></button>\n        </div>\n        <div class=\"modal-body\">\n          是否刪除\n          <strong class=\"text-danger\">{{ coupon.title }}</strong>\n          的優惠券(刪除後將無法恢復)。\n        </div>\n        <div class=\"modal-footer\">\n          <button\n            type=\"button\"\n            class=\"btn btn-outline-secondary\"\n            data-bs-dismiss=\"modal\"\n          >\n            取消\n          </button>\n          <button type=\"button\" class=\"btn btn-danger\" @click=\"deleteCoupon\">\n            確認刪除\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n\nimport Modal from 'bootstrap/js/dist/modal.js'\n\nexport default {\n  props: ['tempCoupon'],\n  data () {\n    return {\n      modal: null,\n      coupon: {}\n      // loading\n      // isLoading: false,\n      // loader: null\n    }\n  },\n  mounted () {\n    this.modal = new Modal(this.$refs.modal, null)\n  },\n  watch: {\n    // isLoading (status) {\n    //   if (status) {\n    //     this.loader = this.$loading.show({\n    //       container: null\n    //     })\n    //     return\n    //   }\n    //   if (this.loader) this.loader.hide()\n    // },\n    tempCoupon () {\n      this.coupon = { ...this.tempCoupon }\n      console.log(this.coupon)\n    }\n  },\n  methods: {\n    openModal () {\n      this.modal.show()\n    },\n\n    deleteCoupon () {\n      this.$emitter.emit('loading', true)\n\n      this.$http.delete(`${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon/${this.tempCoupon.id}`)\n        .then(res => {\n          console.log(res.data)\n          if (!res.data.success) {\n            this.$toastMsg('刪除優惠券失敗！')\n            this.$emitter.emit('loading', false)\n            return\n          }\n          this.$toastMsg('成功刪除優惠券！', 'success')\n          this.$emitter.emit('loading', false)\n\n          this.modal.hide()\n          this.$emit('updateData')\n        })\n        .catch(err => console.dir(err))\n    }\n  }\n}\n</script>\n","import { render } from \"./DeleteCouponModal.vue?vue&type=template&id=014ffbe4\"\nimport script from \"./DeleteCouponModal.vue?vue&type=script&lang=js\"\nexport * from \"./DeleteCouponModal.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { render } from \"./Coupons.vue?vue&type=template&id=6b34797b\"\nimport script from \"./Coupons.vue?vue&type=script&lang=js\"\nexport * from \"./Coupons.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}