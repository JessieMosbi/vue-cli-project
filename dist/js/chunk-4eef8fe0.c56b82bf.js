(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4eef8fe0"],{a434:function(e,t,o){"use strict";var c=o("23e7"),a=o("23cb"),r=o("a691"),d=o("50c4"),l=o("7b0b"),n=o("65f0"),i=o("8418"),s=o("1dde"),u=s("splice"),p=Math.max,b=Math.min,m=9007199254740991,h="Maximum allowed length exceeded";c({target:"Array",proto:!0,forced:!u},{splice:function(e,t){var o,c,s,u,j,f,O=l(this),g=d(O.length),V=a(e,g),N=arguments.length;if(0===N?o=c=0:1===N?(o=0,c=g-V):(o=N-2,c=b(p(r(t),0),g-V)),g+o-c>m)throw TypeError(h);for(s=n(O,c),u=0;u<c;u++)j=V+u,j in O&&i(s,u,O[j]);if(s.length=c,o<c){for(u=V;u<g-c;u++)j=u+c,f=u+o,j in O?O[f]=O[j]:delete O[f];for(u=g;u>g-c+o;u--)delete O[u-1]}else if(o>c)for(u=g-c;u>V;u--)j=u+c-1,f=u+o-1,j in O?O[f]=O[j]:delete O[f];for(u=0;u<o;u++)O[u+V]=arguments[u+2];return O.length=g-c+o,s}})},d416:function(e,t,o){"use strict";o.r(t);var c=o("7a23"),a={class:"text-end mt-4"},r={class:"table mt-4"},d=Object(c["createVNode"])("thead",null,[Object(c["createVNode"])("tr",null,[Object(c["createVNode"])("th",{width:"120"},"分類"),Object(c["createVNode"])("th",null,"產品名稱"),Object(c["createVNode"])("th",{width:"120"},"原價"),Object(c["createVNode"])("th",{width:"120"},"售價"),Object(c["createVNode"])("th",{width:"100"},"是否啟用"),Object(c["createVNode"])("th",{width:"120"},"編輯")])],-1),l={class:"text-end"},n={class:"text-end"},i={key:0,class:"text-success"},s={key:1},u={class:"btn-group"};function p(e,t,o,p,b,m){var h=Object(c["resolveComponent"])("pagination"),j=Object(c["resolveComponent"])("product-modal"),f=Object(c["resolveComponent"])("delete-product-modal");return Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],null,[Object(c["createVNode"])("div",a,[Object(c["createVNode"])("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=function(e){return m.openModal("add")})}," 建立新的產品 ")]),Object(c["createVNode"])("table",r,[d,Object(c["createVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(b.products,(function(t){return Object(c["openBlock"])(),Object(c["createBlock"])("tr",{key:t.id},[Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(t.category),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(t.title),1),Object(c["createVNode"])("td",l,"$"+Object(c["toDisplayString"])(e.currency(t.origin_price)),1),Object(c["createVNode"])("td",n,"$"+Object(c["toDisplayString"])(e.currency(t.price)),1),Object(c["createVNode"])("td",null,[t.is_enabled?(Object(c["openBlock"])(),Object(c["createBlock"])("span",i,"啟用")):(Object(c["openBlock"])(),Object(c["createBlock"])("span",s,"未啟用"))]),Object(c["createVNode"])("td",null,[Object(c["createVNode"])("div",u,[Object(c["createVNode"])("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:function(e){return m.openModal("edit",t.id)}}," 編輯 ",8,["onClick"]),Object(c["createVNode"])("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:function(e){return m.openModal("delete",t.id)}}," 刪除 ",8,["onClick"])])])])})),128))])]),Object(c["createVNode"])(h,{"total-pages":b.page.total,"current-page":b.page.current,"has-pre-page":b.page.hasPre,"has-next-page":b.page.hasNext,onChangePage:m.getData},null,8,["total-pages","current-page","has-pre-page","has-next-page","onChangePage"]),Object(c["createVNode"])(j,{ref:"productModal","temp-product":b.tempProduct,action:b.nowAction,onUpdateData:m.getData},null,8,["temp-product","action","onUpdateData"]),Object(c["createVNode"])(f,{ref:"delProductModal","temp-product":b.tempProduct,onUpdateData:m.getData},null,8,["temp-product","onUpdateData"])],64)}var b=o("5530"),m=(o("99af"),o("7db0"),o("1799")),h=(o("a4d3"),o("e01a"),{id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"}),j={class:"modal-dialog modal-xl"},f={class:"modal-content border-0"},O={class:"modal-header bg-dark text-white"},g={id:"productModalLabel",class:"modal-title"},V={key:0},N={key:1},v=Object(c["createVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),k={class:"modal-body"},y={class:"row"},P={class:"col-sm-4"},M={class:"mb-1"},w={class:"form-group"},x=Object(c["createVNode"])("label",{for:"imageUrl"},"輸入主圖片網址",-1),B={key:0},U={class:"mb-1"},C={class:"form-group"},S=Object(c["createVNode"])("label",{for:"imageUrl"},"輸入圖片網址",-1),D={key:1},$={class:"col-sm-8"},_={class:"form-group"},L=Object(c["createVNode"])("label",{for:"title"},"標題",-1),F={class:"row"},T={class:"form-group col-md-6"},q=Object(c["createVNode"])("label",{for:"category"},"分類",-1),A={class:"form-group col-md-6"},E=Object(c["createVNode"])("label",{for:"unit"},"單位",-1),J={class:"row"},z={class:"form-group col-md-6"},G=Object(c["createVNode"])("label",{for:"origin_price"},"原價",-1),H={class:"form-group col-md-6"},I=Object(c["createVNode"])("label",{for:"price"},"售價",-1),K=Object(c["createVNode"])("hr",null,null,-1),Q={class:"form-group"},R=Object(c["createVNode"])("label",{for:"description"},"產品描述",-1),W={class:"form-group"},X=Object(c["createVNode"])("label",{for:"content"},"說明內容",-1),Y={class:"form-group"},Z={class:"form-check"},ee=Object(c["createVNode"])("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),te={class:"modal-footer"},oe=Object(c["createVNode"])("button",{type:"submit",class:"btn btn-primary"},"確認",-1);function ce(e,t,o,a,r,d){var l=Object(c["resolveComponent"])("Field"),n=Object(c["resolveComponent"])("Form");return Object(c["openBlock"])(),Object(c["createBlock"])("div",h,[Object(c["createVNode"])("div",j,[Object(c["createVNode"])("div",f,[Object(c["createVNode"])("div",O,[Object(c["createVNode"])("h5",g,[r.product.id?(Object(c["openBlock"])(),Object(c["createBlock"])("span",V,"編輯產品")):(Object(c["openBlock"])(),Object(c["createBlock"])("span",N,"新增產品"))]),v]),Object(c["createVNode"])(n,{class:"m-4",onSubmit:d.editProduct,ref:"product-form"},{default:Object(c["withCtx"])((function(e){var o=e.errors;return[Object(c["createVNode"])("div",k,[Object(c["createTextVNode"])(Object(c["toDisplayString"])(r.product)+" ",1),Object(c["createVNode"])("div",y,[Object(c["createVNode"])("div",P,[Object(c["createVNode"])("div",M,[Object(c["createVNode"])("div",w,[x,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":t[1]||(t[1]=function(e){return r.product.imageUrl=e})},null,512),[[c["vModelText"],r.product.imageUrl,void 0,{trim:!0}]])]),Object(c["createVNode"])("img",{class:"img-fluid",src:r.product.imageUrl,alt:r.product.imageUrl},null,8,["src","alt"])]),r.product.imageUrl?(Object(c["openBlock"])(),Object(c["createBlock"])("div",B,[Object(c["createVNode"])("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:t[2]||(t[2]=function(e){return d.deletePicture("main")})}," 刪除主圖片 ")])):Object(c["createCommentVNode"])("",!0),(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(r.product.imagesUrl,(function(e,t){return Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],{key:t},[Object(c["createVNode"])("div",U,[Object(c["createVNode"])("div",C,[S,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":function(e){return r.product.imagesUrl[t]=e}},null,8,["onUpdate:modelValue"]),[[c["vModelText"],r.product.imagesUrl[t],void 0,{trim:!0}]])]),Object(c["createVNode"])("img",{class:"img-fluid",src:e,alt:e},null,8,["src","alt"])]),Object(c["createVNode"])("div",null,[Object(c["createVNode"])("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:function(e){return d.deletePicture(t)}}," 刪除圖片 ",8,["onClick"])])],64)})),128)),r.product.imagesUrl.length<5?(Object(c["openBlock"])(),Object(c["createBlock"])("div",D,[Object(c["createVNode"])("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:t[3]||(t[3]=function(){return d.addPicture&&d.addPicture.apply(d,arguments)})}," 新增圖片 ")])):Object(c["createCommentVNode"])("",!0)]),Object(c["createVNode"])("div",$,[Object(c["createVNode"])("div",_,[L,Object(c["createVNode"])(l,{type:"text",id:"title",name:"標題",class:["form-control",{"is-invalid":o["標題"]}],rules:"required",modelValue:r.product.title,"onUpdate:modelValue":t[4]||(t[4]=function(e){return r.product.title=e}),modelModifiers:{trim:!0},placeholder:"請輸入標題"},null,8,["class","modelValue"]),r.isClickSendBtn?(Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:0,class:["invalid-feedback",{"d-block":!r.product.title}]}," 標題為必填 ",2)):Object(c["createCommentVNode"])("",!0)]),Object(c["createVNode"])("div",F,[Object(c["createVNode"])("div",T,[q,Object(c["createVNode"])(l,{type:"text",id:"category",name:"分類",class:["form-control",{"is-invalid":o["分類"]}],rules:"required",modelValue:r.product.category,"onUpdate:modelValue":t[5]||(t[5]=function(e){return r.product.category=e}),modelModifiers:{trim:!0},placeholder:"請輸入分類"},null,8,["class","modelValue"])]),Object(c["createVNode"])("div",A,[E,Object(c["createVNode"])(l,{type:"text",id:"unit",name:"單位",class:["form-control",{"is-invalid":o["單位"]}],rules:"required",modelValue:r.product.unit,"onUpdate:modelValue":t[6]||(t[6]=function(e){return r.product.unit=e}),modelModifiers:{trim:!0},placeholder:"請輸入單位"},null,8,["class","modelValue"])])]),Object(c["createVNode"])("div",J,[Object(c["createVNode"])("div",z,[G,Object(c["createVNode"])(l,{type:"number",id:"origin_price",name:"原價",class:["form-control",{"is-invalid":o["原價"]}],min:"0",rules:"required",modelValue:r.product.origin_price,"onUpdate:modelValue":t[7]||(t[7]=function(e){return r.product.origin_price=e}),modelModifiers:{number:!0},placeholder:"請輸入原價"},null,8,["class","modelValue"])]),Object(c["createVNode"])("div",H,[I,Object(c["createVNode"])(l,{type:"number",id:"price",name:"售價",class:["form-control",{"is-invalid":o["售價"]}],min:"0",rules:"required",modelValue:r.product.price,"onUpdate:modelValue":t[8]||(t[8]=function(e){return r.product.price=e}),modelModifiers:{number:!0},placeholder:"請輸入售價"},null,8,["class","modelValue"])])]),K,Object(c["createVNode"])("div",Q,[R,Object(c["createVNode"])(l,{as:"textarea",id:"description",name:"產品描述",class:"form-control",modelValue:r.product.description,"onUpdate:modelValue":t[9]||(t[9]=function(e){return r.product.description=e}),modelModifiers:{trim:!0},placeholder:"請輸入產品描述"},null,8,["modelValue"])]),Object(c["createVNode"])("div",W,[X,Object(c["createVNode"])(l,{as:"textarea",id:"content",name:"說明內容",class:"form-control",modelValue:r.product.content,"onUpdate:modelValue":t[10]||(t[10]=function(e){return r.product.content=e}),modelModifiers:{trim:!0},placeholder:"請輸入說明內容"},null,8,["modelValue"])]),Object(c["createVNode"])("div",Y,[Object(c["createVNode"])("div",Z,[Object(c["createVNode"])(l,{type:"checkbox",id:"is_enabled",name:"是否啟用",class:"form-check-input","true-value":1,"false-value":0,modelValue:r.product.is_enabled,"onUpdate:modelValue":t[11]||(t[11]=function(e){return r.product.is_enabled=e})},null,8,["modelValue"]),ee])])])])]),Object(c["createVNode"])("div",te,[Object(c["createVNode"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal",onClick:t[12]||(t[12]=function(e){return r.isClickSendBtn=0})}," 取消 "),oe])]})),_:1},8,["onSubmit"])])])],512)}o("159b"),o("b64b"),o("a434");var ae=o("7c2b"),re=o.n(ae),de={props:["tempProduct","action"],data:function(){return{isClickSendBtn:0,modal:null,product:{imagesUrl:[]}}},mounted:function(){this.modal=new re.a(this.$refs.productModal,null)},watch:{tempProduct:function(){var e=this;console.log("tempProduct watch"),console.log("tempProduct"),console.log(this.tempProduct),Object.keys(this.product).forEach((function(t){e.product[t]="","imagesUrl"===t&&(e.product[t]=[])})),Object.keys(this.tempProduct).forEach((function(t){e.product[t]=e.tempProduct[t]})),console.log("product"),console.log(this.product)}},methods:{openModal:function(){console.log("openModal"),this.modal.show()},editProduct:function(){var e=this;if(this.isClickSendBtn=1,this.product.title&&this.product.category&&this.product.unit&&this.product.origin_price&&this.product.price){var t="",o="",c="",a={data:this.product};"add"===this.action?(t="新增",o="".concat("https://vue3-course-api.hexschool.io","/api/").concat("jessiemosbi","/admin/product"),c="post"):"edit"===this.action&&(t="編輯",o="".concat("https://vue3-course-api.hexschool.io","/api/").concat("jessiemosbi","/admin/product/").concat(this.product.id),c="put"),this.$http[c](o,a).then((function(o){o.data.success?(alert("".concat(t,"成功！")),e.modal.hide(),e.$emit("updateData"),e.isClickSendBtn=0):alert("".concat(t,"失敗！"))})).catch((function(e){return console.dir(e)}))}else alert("請檢查必填欄位！")},addPicture:function(){5!==this.product.imagesUrl.length&&this.product.imagesUrl.push("")},deletePicture:function(e){"main"===e?this.product.imageUrl="":this.product.imagesUrl.splice(e,1)}}};de.render=ce;var le=de,ne={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},ie={class:"modal-dialog"},se={class:"modal-content border-0"},ue=Object(c["createVNode"])("div",{class:"modal-header bg-danger text-white"},[Object(c["createVNode"])("h5",{id:"delProductModalLabel",class:"modal-title"},[Object(c["createVNode"])("span",null,"刪除產品")]),Object(c["createVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),pe={class:"modal-body"},be=Object(c["createTextVNode"])(" 是否刪除 "),me={class:"text-danger"},he=Object(c["createTextVNode"])(" 商品(刪除後將無法恢復)。 "),je={class:"modal-footer"},fe=Object(c["createVNode"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Oe(e,t,o,a,r,d){return Object(c["openBlock"])(),Object(c["createBlock"])("div",ne,[Object(c["createVNode"])("div",ie,[Object(c["createVNode"])("div",se,[ue,Object(c["createVNode"])("div",pe,[be,Object(c["createVNode"])("strong",me,Object(c["toDisplayString"])(o.tempProduct.title),1),he]),Object(c["createVNode"])("div",je,[fe,Object(c["createVNode"])("button",{type:"button",class:"btn btn-danger",onClick:t[1]||(t[1]=function(){return d.deleteProduct&&d.deleteProduct.apply(d,arguments)})}," 確認刪除 ")])])])],512)}var ge={props:["tempProduct"],data:function(){return{modal:null,product:{}}},mounted:function(){this.modal=new re.a(this.$refs.delProductModal,null)},watch:{tempProduct:function(){this.product=Object(b["a"])({},this.tempProduct)}},methods:{openModal:function(){this.modal.show()},deleteProduct:function(){var e=this;this.$http.delete("".concat("https://vue3-course-api.hexschool.io","/api/").concat("jessiemosbi","/admin/product/").concat(this.tempProduct.id)).then((function(t){t.data.success?(alert("成功刪除產品！"),e.modal.hide(),e.$emit("updateData")):alert("刪除產品失敗！")})).catch((function(e){return console.dir(e)}))}}};ge.render=Oe;var Ve=ge,Ne={data:function(){return{products:[],page:{total:0,current:0,hasPre:!1,hasNext:!1},tempProduct:{imagesUrl:[]},nowAction:"",isLoading:!1,loader:null}},components:{pagination:m["a"],productModal:le,deleteProductModal:Ve},mounted:function(){this.getData()},watch:{isLoading:function(e){e?this.loader=this.$loading.show({container:null}):this.loader&&this.loader.hide()}},methods:{getData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isLoading=!0,this.$http.get("".concat("https://vue3-course-api.hexschool.io","/api/").concat("jessiemosbi","/admin/products?page=").concat(t)).then((function(t){if(!t.data.success)return alert("獲取產品列表資料失敗！"),void(e.isLoading=!1);e.products=t.data.products,e.page.total=t.data.pagination.total_pages,e.page.current=t.data.pagination.current_page,e.page.hasPre=t.data.pagination.has_pre,e.page.hasNext=t.data.pagination.has_next,e.isLoading=!1})).catch((function(e){return console.dir(e)}))},openModal:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.nowAction=e,this.$refs.productModal.$refs["product-form"].resetForm(),"add"===e||"edit"!==e&&"delete"!==e||!t||(this.tempProduct=Object(b["a"])(Object(b["a"])({},this.products.find((function(e){return e.id===t}))),{},{id:t})),this.tempProduct.num=1,"add"===e||"edit"===e?this.$refs.productModal.openModal():"delete"===e&&this.$refs.delProductModal.openModal()}}};Ne.render=p;t["default"]=Ne},e01a:function(e,t,o){"use strict";var c=o("23e7"),a=o("83ab"),r=o("da84"),d=o("5135"),l=o("861d"),n=o("9bf2").f,i=o("e893"),s=r.Symbol;if(a&&"function"==typeof s&&(!("description"in s.prototype)||void 0!==s().description)){var u={},p=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof p?new s(e):void 0===e?s():s(e);return""===e&&(u[t]=!0),t};i(p,s);var b=p.prototype=s.prototype;b.constructor=p;var m=b.toString,h="Symbol(test)"==String(s("test")),j=/^Symbol\((.*)\)[^)]+$/;n(b,"description",{configurable:!0,get:function(){var e=l(this)?this.valueOf():this,t=m.call(e);if(d(u,e))return"";var o=h?t.slice(7,-1):t.replace(j,"$1");return""===o?void 0:o}}),c({global:!0,forced:!0},{Symbol:p})}}}]);
//# sourceMappingURL=chunk-4eef8fe0.c56b82bf.js.map